{
  "entities": {
    "Volunteer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Volunteer",
      "type": "object",
      "description": "Represents a volunteer user in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the volunteer."
        },
        "firstName": {
          "type": "string",
          "description": "The volunteer's first name."
        },
        "lastName": {
          "type": "string",
          "description": "The volunteer's last name."
        },
        "email": {
          "type": "string",
          "description": "The volunteer's email address.",
          "format": "email"
        },
        "skills": {
          "type": "array",
          "description": "List of skills the volunteer possesses.",
          "items": {
            "type": "string"
          }
        },
        "experience": {
          "type": "string",
          "description": "Description of the volunteer's relevant experience."
        },
        "availability": {
          "type": "string",
          "description": "The volunteer's availability (e.g., days/hours per week)."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "skills",
        "experience",
        "availability"
      ]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project listed by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the project."
        },
        "creatorId": {
          "type": "string",
          "description": "The UID of the user who created the project."
        },
        "creatorName": {
          "type": "string",
          "description": "The display name of the user who created the project."
        },
        "creatorAvatarUrl": {
          "type": "string",
          "description": "The avatar URL of the user who created the project."
        },
        "title": {
          "type": "string",
          "description": "The title of the project."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the project."
        },
        "requiredSkills": {
          "type": "array",
          "description": "List of skills required for the project.",
          "items": {
            "type": "string"
          }
        },
        "estimatedTimeCommitment": {
          "type": "string",
          "description": "Estimated time commitment for the project (e.g., hours per week, total duration)."
        }
      },
      "required": [
        "id",
        "creatorId",
        "creatorName",
        "title",
        "description",
        "requiredSkills",
        "estimatedTimeCommitment"
      ]
    },
    "NonProfit": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "NonProfit",
      "type": "object",
      "description": "Represents a non-profit organization.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the non-profit."
        },
        "name": {
          "type": "string",
          "description": "The name of the non-profit organization."
        },
        "description": {
          "type": "string",
          "description": "A description of the non-profit organization."
        },
        "contactEmail": {
          "type": "string",
          "description": "The contact email address for the non-profit organization.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "contactEmail"
      ]
    },
    "ProjectVolunteer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectVolunteer",
      "type": "object",
      "description": "Represents the association between a Project and a Volunteer (Many-to-Many relationship).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for this ProjectVolunteer association."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project N:N Volunteer)"
        },
        "volunteerId": {
          "type": "string",
          "description": "Reference to Volunteer. (Relationship: Project N:N Volunteer)"
        }
      },
      "required": [
        "id",
        "projectId",
        "volunteerId"
      ]
    },
    "Message": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Message",
      "type": "object",
      "description": "Represents a message exchanged between a non-profit and a volunteer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the message."
        },
        "senderId": {
          "type": "string",
          "description": "ID of the user sending the message (can be NonProfit or Volunteer)."
        },
        "recipientId": {
          "type": "string",
          "description": "ID of the user receiving the message (can be NonProfit or Volunteer)."
        },
        "messageText": {
          "type": "string",
          "description": "The content of the message."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the message was sent.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "senderId",
        "recipientId",
        "messageText",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/nonProfits/{nonProfitId}",
        "definition": {
          "entityName": "NonProfit",
          "schema": {
            "$ref": "#/backend/entities/NonProfit"
          },
          "description": "Stores non-profit organization profiles.",
          "params": [
            {
              "name": "nonProfitId",
              "description": "Unique identifier for the non-profit organization."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/backend/entities/Project"
          },
          "description": "Stores project listings. Includes the 'creatorId' field for authorization.",
          "params": [
            {
              "name": "projectId",
              "description": "Unique identifier for the project."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/volunteerProfile",
        "definition": {
          "entityName": "Volunteer",
          "schema": {
            "$ref": "#/backend/entities/Volunteer"
          },
          "description": "Stores individual volunteer profiles.  Access is restricted to the authenticated user.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user (volunteer)."
            }
          ]
        }
      },
      {
        "path": "/projectVolunteers/{projectVolunteerId}",
        "definition": {
          "entityName": "ProjectVolunteer",
          "schema": {
            "$ref": "#/backend/entities/ProjectVolunteer"
          },
          "description": "Stores the many-to-many relationships between projects and volunteers.",
          "params": [
            {
              "name": "projectVolunteerId",
              "description": "Unique identifier for the ProjectVolunteer association."
            }
          ]
        }
      },
      {
        "path": "/chats/{chatId}/messages/{messageId}",
        "definition": {
          "entityName": "Message",
          "schema": {
            "$ref": "#/backend/entities/Message"
          },
          "description": "Stores messages within a chat between a non-profit and a volunteer. Includes 'senderId' and 'recipientId' for authorization.",
          "params": [
            {
              "name": "chatId",
              "description": "Unique identifier for the chat."
            },
            {
              "name": "messageId",
              "description": "Unique identifier for the message."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support VolunteerConnect's core features (Project Listing, Volunteer Profiles, Project Selection, and Communication Portal) while adhering to the principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), QAPs (Rules are not Filters), and Invariants.  Authorization Independence is achieved through denormalization; specifically, the `projects` collection includes the `creatorId`, enabling rules to validate project ownership without resorting to `get()` calls. The `messages` subcollection of `chats` denormalizes both `senderId` and `recipientId`, allowing message access control based solely on the message document itself. Structural Segregation is implemented by storing volunteers' private data under `/users/{userId}/volunteerProfile` to ensure that only the volunteer can access their profile. Collaborative data (ProjectVolunteer assignments) is modeled using a dedicated collection `/projectVolunteers`.\n\nThe key collections and subcollections are:\n\n*   `/nonProfits/{nonProfitId}`: Stores non-profit organization profiles.\n*   `/projects/{projectId}`: Stores project listings. Includes the `nonProfitId` field for authorization.\n*   `/users/{userId}/volunteerProfile`: Stores individual volunteer profiles.  Access is restricted to the authenticated user.\n*   `/projectVolunteers/{projectVolunteerId}`: Stores the many-to-many relationships between projects and volunteers.\n*   `/chats/{chatId}/messages/{messageId}`: Stores messages within a chat between a non-profit and a volunteer. Includes `senderId` and `recipientId` for authorization."
  }
}
    